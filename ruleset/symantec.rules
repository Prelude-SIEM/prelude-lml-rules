#####
#
# Copyright (C) 2012 <operador@sesabe.mooo.com>
# All Rights Reserved
#
# This file is part of the Prelude-LML program.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2, or (at your option)
# any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License along
# with this program; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
#####


#####
#
# Rules to monitor the Symantec SEP 12.1 AV
# 
#####


#Dec  1 12:23:14 SymantecServer xxx: Site: xxx,Server: xxx1,Successfully downloaded
regex=SymantecServer (\S+): Site: (\S+),Server: (\S+),Successfully downloaded the Virus and Spyware definitions; \
 classification.text=Virus and Spyware definition update; \
 id=33203; \
 revision=2; \
 analyzer(0).name=Symantec Antivirus; \
 analyzer(0).manufacturer=www.symantec.com; \
 analyzer(0).class=Antivirus; \
 assessment.impact.severity=info; \
 assessment.impact.type=other; \
 assessment.impact.completion=succeeded; \
 assessment.impact.description=Symantec Virus and Spyware definitions have been updated; \
 additional_data(0).type=string; \
 additional_data(0).meaning=Site Name; \
 additional_data(0).data=$2; \
 source(0).node.address(0).category=ipv4-addr; \
 source(0).node.address(0).address=$3; \
 target(0).node.address(0).category=ipv4-addr; \
 target(0).node.address(0).address=$1; \
 last

#Dec  1 12:23:14 SymantecServer xxx: Site: xxx,Server: xxx,Successfully downloaded
regex=SymantecServer (\S+): Site: (\S+),Server: (\S+),Successfully downloaded the SONAR; \
 classification.text=SONAR definition update; \
 id=33208; \
 revision=2; \
 analyzer(0).name=Symantec Antivirus; \
 analyzer(0).manufacturer=www.symantec.com; \
 analyzer(0).class=Antivirus; \
 assessment.impact.severity=info; \
 assessment.impact.type=other; \
 assessment.impact.completion=succeeded; \
 assessment.impact.description=SONAR definitions have been updated; \
 additional_data(0).type=string; \
 additional_data(0).meaning=Site Name; \
 additional_data(0).data=$2; \
 source(0).node.address(0).category=ipv4-addr; \
 source(0).node.address(0).address=$3; \
 target(0).node.address(0).category=ipv4-addr; \
 target(0).node.address(0).address=$1; \
 last

#Dec  1 12:23:14 SymantecServer xxx: Site: xxx,Server: xxx,Successfully downloaded
regex=SymantecServer (\S+): Site: (\S+),Server: (\S+),Successfully downloaded the Intrusion Prevention signatures; \
 classification.text=Intrusion Prevention signatures definition update; \
 id=33209; \
 revision=2; \
 analyzer(0).name=Symantec Antivirus; \
 analyzer(0).manufacturer=www.symantec.com; \
 analyzer(0).class=Antivirus; \
 assessment.impact.severity=info; \
 assessment.impact.type=other; \
 assessment.impact.completion=succeeded; \
 assessment.impact.description=Intrusion Prevention signatures definitions have been updated; \
 additional_data(0).type=string; \
 additional_data(0).meaning=Site Name; \
 additional_data(0).data=$2; \
 source(0).node.address(0).category=ipv4-addr; \
 source(0).node.address(0).address=$3; \
 target(0).node.address(0).category=ipv4-addr; \
 target(0).node.address(0).address=$1; \
 last

#Apr  9 10:47:33 SymantecServer xxx: Site: xxx,Server: xxx,Successfully downloaded the Revocation Data security definitions from LiveUpdate
regex=SymantecServer (\S+): Site: (\S+),Server: (\S+),Successfully downloaded the Revocation Data security definitions from LiveUpdate; \
 classification.text=Revocation Data security definitions; \
 id=33204; \
 revision=2; \
 analyzer(0).name=Symantec Antivirus; \
 analyzer(0).manufacturer=www.symantec.com; \
 analyzer(0).class=Antivirus; \
 assessment.impact.severity=info; \
 assessment.impact.type=other; \
 assessment.impact.completion=succeeded; \
 assessment.impact.description=Successfully downloaded the Revocation Data security definitions; \
 additional_data(0).type=string; \
 additional_data(0).meaning=Site Name; \
 additional_data(0).data=$2; \
 source(0).node.address(0).category=ipv4-addr; \
 source(0).node.address(0).address=$3; \
 last

#Dec 12 17:07:08 SymantecServer xxx: Virus found,Computer name: xxx,Source: Real Time Scan,Risk name: W32.Downadup!autorun,Occurrences: 1,E:\autorun.inf,"",Actual action: Cleaned by deletion
regex=SymantecServer (\S+): Virus found,Computer name: (\S+),Source: (\S+) (\S+) (\S+),Risk name: (\S+); \
 classification.text=Virus found; \
 id=33205; \
 revision=2; \
 analyzer(0).name=Symantec Antivirus; \
 analyzer(0).manufacturer=www.symantec.com; \
 analyzer(0).class=Antivirus; \
 assessment.impact.severity=high; \
 assessment.impact.type=file; \
 assessment.impact.completion=succeeded; \
 assessment.impact.description= Virus found, Computer name: $2; \
 additional_data(0).type=string; \
 additional_data(0).meaning=Computer Name; \
 additional_data(0).data=$2; \
 additional_data(1).type=string; \
 additional_data(1).meaning=Category; \
 additional_data(1).data=$3 $4 $5; \
 additional_data(1).type=string; \
 additional_data(1).meaning=Risk name; \
 additional_data(1).data=$6; \
 source(0).node.address(0).category=ipv4-addr; \
 source(0).node.address(0).address=$1; \
 target(0).node.address(0).category=ipv4-addr; \
 target(0).node.address(0).address=$2; \
 last

regex=SymantecServer (\S+): Forced SONAR threat detected,Computer name: (\S+),Detection type: (\d+),First Seen: Reputation was not used in this detection.,Application name: \((\S+)\); \
 classification.text=Forced SONAR threat detected; \
 id=33206; \
 revision=2; \
 analyzer(0).name=Symantec Antivirus; \
 analyzer(0).manufacturer=www.symantec.com; \
 analyzer(0).class=Antivirus; \
 assessment.impact.severity=high; \
 assessment.impact.type=file; \
 assessment.impact.completion=succeeded; \
 assessment.impact.description= SONAR threat detected, Computer name: $2; \
 additional_data(0).type=string; \
 additional_data(0).meaning=Computer Name; \
 additional_data(0).data=$2; \
 additional_data(1).type=string; \
 additional_data(1).meaning=Detection type; \
 additional_data(1).data=$3; \
 additional_data(1).type=string; \
 additional_data(1).meaning=Application name; \
 additional_data(1).data=$4; \
 source(0).node.address(0).category=ipv4-addr; \
 source(0).node.address(0).address=$1; \
 target(0).node.address(0).category=ipv4-addr; \
 target(0).node.address(0).address=$2; \
 last

